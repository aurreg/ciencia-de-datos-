<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analisis Descriptivo Multivariado</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Analisis Descriptivo Multivariado_files/libs/clipboard/clipboard.min.js"></script>
<script src="Analisis Descriptivo Multivariado_files/libs/quarto-html/quarto.js"></script>
<script src="Analisis Descriptivo Multivariado_files/libs/quarto-html/popper.min.js"></script>
<script src="Analisis Descriptivo Multivariado_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Analisis Descriptivo Multivariado_files/libs/quarto-html/anchor.min.js"></script>
<link href="Analisis Descriptivo Multivariado_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Analisis Descriptivo Multivariado_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Analisis Descriptivo Multivariado_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Analisis Descriptivo Multivariado_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Analisis Descriptivo Multivariado_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analisis Descriptivo Multivariado</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="procesamiento-de-variables" class="level1">
<h1>Procesamiento de variables</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cambia idioma de la consola de R a español:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">LANG=</span><span class="st">"es"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># usar 2 cifras significativas y tiende a evitar </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># notación científica (ver ayuda de función: `options`): </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scipen =</span> <span class="dv">999</span>) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar librerías: </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías y suprimir mensajes y advertencias individualmente</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(FactoClass)))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(Factoshiny)))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(factoextra)))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(plotly)))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(dplyr)))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(readxl)))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(ggplot2)))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(knitr)))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(htmlwidgets)))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">suppressWarnings</span>(<span class="fu">library</span>(ggpubr)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"SUPPPORT2.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">num.co=</span><span class="fu">case_when</span>(num.co<span class="sc">&gt;=</span><span class="dv">4</span><span class="sc">~</span> <span class="st">'4+'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(num.co)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)]<span class="ot">&lt;-</span><span class="fu">lapply</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)],as.factor)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,105 × 45
     age sex    dzgroup dzclass num.co   edu income scoma charges totcst totmcst
   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;   &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1  62.8 male   Lung C… Cancer  0         11 $11-$…     0    9715     NA      NA
 2  60.3 female Cirrho… COPD/C… 2         12 $11-$…    44   34496     NA      NA
 3  52.7 female Cirrho… COPD/C… 2         12 under…     0   41094     NA      NA
 4  42.4 female Lung C… Cancer  2         11 under…     0    3075     NA      NA
 5  79.9 female ARF/MO… ARF/MO… 1         NA &lt;NA&gt;      26   50127     NA      NA
 6  93.0 male   Coma    Coma    1         14 &lt;NA&gt;      55    6884     NA      NA
 7  62.4 male   CHF     COPD/C… 1         14 $25-$…     0   30460     NA      NA
 8  86.8 male   CHF     COPD/C… 3         NA &lt;NA&gt;      26   30460     NA      NA
 9  85.7 male   Lung C… Cancer  2         12 &lt;NA&gt;      26      NA     NA      NA
10  42.3 female Colon … Cancer  0         11 $25-$…     0    9914     NA      NA
# ℹ 9,095 more rows
# ℹ 34 more variables: avtisst &lt;dbl&gt;, race &lt;fct&gt;, sps &lt;dbl&gt;, aps &lt;dbl&gt;,
#   surv2m &lt;dbl&gt;, surv6m &lt;dbl&gt;, hday &lt;dbl&gt;, diabetes &lt;fct&gt;, dementia &lt;fct&gt;,
#   ca &lt;fct&gt;, prg2m &lt;dbl&gt;, prg6m &lt;dbl&gt;, dnr &lt;fct&gt;, dnrday &lt;dbl&gt;, meanbp &lt;dbl&gt;,
#   wblc &lt;dbl&gt;, hrt &lt;dbl&gt;, resp &lt;dbl&gt;, temp &lt;dbl&gt;, pafi &lt;dbl&gt;, alb &lt;dbl&gt;,
#   bili &lt;dbl&gt;, crea &lt;dbl&gt;, sod &lt;dbl&gt;, ph &lt;dbl&gt;, glucose &lt;dbl&gt;, bun &lt;dbl&gt;,
#   urine &lt;dbl&gt;, adlp &lt;fct&gt;, adls &lt;fct&gt;, adlsc &lt;dbl&gt;, death &lt;fct&gt;, …</code></pre>
</div>
</div>
<p><strong>Sex</strong></p>
<p>La variable Sex no parece nesesitar ninguna recategorizacion.</p>
<p>Nuevos Niveles:</p>
<p>female : f</p>
<p>male : m</p>
<p><strong>dzgroup: Subcategoría enfermedad del paciente.</strong></p>
<p>Nuevos Niveles:</p>
<p>Lung Cancer = L.C</p>
<p>Cirrhosis = C</p>
<p>ARF/MOSF w/ Sepsis = A.M.S</p>
<p>Coma = Coma</p>
<p>CHF = CHF</p>
<p>Colon Cancer&nbsp;= C.C</p>
<p>COPD = COPD</p>
<p>MOSF w/Malig = M.M</p>
<p><strong>dzclass:Categoría enfermedad del paciante.</strong></p>
<p>Nuevos Niveles:</p>
<p>ARF/MOSF = A.M</p>
<p>Cancer= C</p>
<p>Coma = Coma</p>
<p>COPD/CHF/Cirrhosis = C.C.C</p>
<p><strong>race</strong></p>
<p>Hay muy pocos asiaticos, negros, hispanos y otros por lo que se binzariza la variable en blancos y otros</p>
<p>nuevos nivels</p>
<p>white=w</p>
<p>other=o</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">dzgroup=</span><span class="fu">case_when</span>(dzgroup<span class="sc">==</span><span class="st">"Lung Cancer"</span><span class="sc">~</span> <span class="st">'L.C'</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"Cirrhosis"</span><span class="sc">~</span> <span class="st">'C'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"ARF/MOSF w/Sepsis"</span><span class="sc">~</span> <span class="st">'A.M.S'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"Coma"</span><span class="sc">~</span> <span class="st">'Coma'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"CHF"</span><span class="sc">~</span> <span class="st">'CHF'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"Colon Cancer"</span><span class="sc">~</span> <span class="st">'C.C'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"COPD"</span><span class="sc">~</span> <span class="st">'COPD'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                                        dzgroup<span class="sc">==</span><span class="st">"MOSF w/Malig"</span><span class="sc">~</span> <span class="st">'M.M'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                        T<span class="sc">~</span><span class="st">'NA'</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">dzclass=</span><span class="fu">case_when</span>(dzclass<span class="sc">==</span><span class="st">"ARF/MOSF"</span><span class="sc">~</span> <span class="st">'A.M'</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                                       dzclass<span class="sc">==</span><span class="st">"Cancer"</span><span class="sc">~</span> <span class="st">'C'</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                                       dzclass<span class="sc">==</span><span class="st">"Coma"</span><span class="sc">~</span> <span class="st">'Coma'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                                       T<span class="sc">~</span><span class="st">'C.C.C'</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">race=</span><span class="fu">case_when</span>(race<span class="sc">==</span><span class="st">"white"</span><span class="sc">~</span> <span class="st">'W'</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                                     </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                                     T<span class="sc">~</span><span class="st">'O'</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">dementia=</span><span class="fu">case_when</span>(dementia<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                                         T<span class="sc">~</span><span class="st">'no'</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">diabetes=</span><span class="fu">case_when</span>(diabetes<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                                         T<span class="sc">~</span><span class="st">'no'</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">dnr=</span><span class="fu">case_when</span>(dnr<span class="sc">==</span><span class="st">'dnr after sadm'</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                                    dnr<span class="sc">==</span><span class="st">'dnr before sadm'</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                                         T<span class="sc">~</span><span class="st">'no'</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">death=</span><span class="fu">case_when</span>(death<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                                      </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                                      T<span class="sc">~</span><span class="st">'no'</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>datos<span class="ot">&lt;-</span>datos<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">hospdead=</span><span class="fu">case_when</span>(hospdead<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                                         T<span class="sc">~</span><span class="st">'no'</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)]<span class="ot">&lt;-</span><span class="fu">lapply</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)],as.factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="acp" class="level3">
<h3 class="anchored" data-anchor-id="acp">ACP</h3>
<p>De acuerdo con el análisis exploratorio de los datos, se decide utilizar como variables activas para el ACP aquellas que presenten menos valores faltantes (NA) y menos valores atípicos (outliers). Las variables seleccionadas son: <strong>“age”</strong>, <strong>“avtisst”</strong>, <strong>“surv2m”</strong>, <strong>“surv6m”</strong>, <strong>“meanbp”</strong>, <strong>“hrt”</strong> y <strong>“temp”</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>outlier_count <span class="ot">&lt;-</span> <span class="cf">function</span>(column) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(column)) { <span class="co"># Verificar si la columna es numérica</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(column, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Primer cuartil</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(column, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Tercer cuartil</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1  <span class="co"># Rango intercuartil</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR  <span class="co"># Límite inferior</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR  <span class="co"># Límite superior</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(column <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> column <span class="sc">&gt;</span> upper_bound, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)  <span class="co"># Si no es numérico, no hay atípicos</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"yellow"</span>,<span class="st">"pink"</span>,<span class="st">"green"</span>,<span class="st">"orange"</span>),<span class="dv">5</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>), <span class="at">las=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="co"># Encuentra las posiciones de las columnas</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"avtisst"</span>, <span class="st">"surv2m"</span>, <span class="st">"surv6m"</span>, <span class="st">"meanbp"</span>, <span class="st">"hrt"</span>, <span class="st">"temp"</span>), <span class="fu">names</span>(datos))) <span class="fu">boxplot</span>(datos[,i], <span class="at">main=</span><span class="fu">names</span>(datos)[i], <span class="at">col=</span>colores[i])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)], outlier_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    age     edu   scoma charges  totcst totmcst avtisst     sps     aps  surv2m 
     56     199    1955     912     749     495      43     283     178     307 
 surv6m    hday   prg2m   prg6m  dnrday  meanbp    wblc     hrt    resp    temp 
      0    1543       0       0     799       6     399      40     313      14 
   pafi     alb    bili    crea     sod      ph glucose     bun   urine   adlsc 
     90      15     926     987     256     260     272     267      92       0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>res.PCA<span class="ot">&lt;-</span><span class="fu">PCA</span>(datos,<span class="at">quali.sup=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>),<span class="at">quanti.sup=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">27</span>,<span class="dv">29</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">37</span>,<span class="dv">38</span>,<span class="dv">39</span>,<span class="dv">42</span>),<span class="at">graph=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in PCA(datos, quali.sup = c(2, 3, 4, 5, 7, 13, 19, 20, 21, 24, 40, :
Missing values are imputed by the mean of the variable: you should use the
imputePCA function of the missMDA package</code></pre>
</div>
</div>
<p>Observando el histograma de los valores propios divididos por la inercia total, se decide analizar cuatro ejes, dado que retienen alrededor del 40% de la variabilidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(res.PCA<span class="sc">$</span>eig[,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(res.PCA<span class="sc">$</span>eig[,<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(res.PCA<span class="sc">$</span>eig[,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(res.PCA<span class="sc">$</span>eig[,<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>comp 1 comp 2 comp 3 comp 4 comp 5 comp 6 comp 7 comp 8 
  0.34   0.52   0.65   0.76   0.86   0.94   1.00   1.00 </code></pre>
</div>
</div>
<p>Las variables que más contribuyen a la construcción del primer eje son los índices de supervivencia Schoma y Avissst. En el segundo eje, las variables principales son la temperatura, la frecuencia cardíaca y la edad. En el tercer eje, predominan la presión arterial y la edad, mientras que en el cuarto eje destacan la edad, la temperatura y la presión arterial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.PCA, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.PCA, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.PCA, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(res.PCA, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se grafican los círculos de correlaciones correspondientes a tres planos factoriales, incluyendo únicamente las variables ilustrativas y activas con un <span class="math inline">\(cos^2 &gt; 0.2\)</span>. Esto se realiza para facilitar la lectura y mejorar la interpretación de los resultados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>umbral_cos2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>variables_filtradas <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>variables_filtradas2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>quanti.sup<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>quanti<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>variables_filtradas<span class="ot">&lt;-</span><span class="fu">c</span>(variables_filtradas,variables_filtradas2)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.PCA, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">col.var=</span><span class="st">"cos2"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">name =</span>variables_filtradas),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkorange"</span>, </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el primer eje se puede observar una correlación positiva con el índice y la estimación de supervivencia de los pacientes, y una correlación negativa con el score de coma y la puntuación promedio del sistema de calificación de la intervención terapéutica (TISS), que cuantifica la intensidad del tratamiento suministrado al paciente.</p>
<p>El segundo eje presenta una correlación positiva con el TISS, la temperatura y la frecuencia cardíaca, y una correlación negativa con la edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>umbral_cos2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>variables_filtradas <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>variables_filtradas2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>quanti.sup<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>quanti<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>variables_filtradas<span class="ot">&lt;-</span><span class="fu">c</span>(variables_filtradas,variables_filtradas2)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.PCA, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">col.var=</span><span class="st">"cos2"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">name =</span>variables_filtradas),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkorange"</span>, </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el tercer eje se observa una alta correlación positiva con la presión arterial, mientras que en el cuarto eje se identifica una correlación positiva con la temperatura, la edad y la presión arterial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>umbral_cos2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>variables_filtradas <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>var<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>variables_filtradas2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>quanti.sup<span class="sc">$</span>cos2)[<span class="fu">apply</span>(res.PCA<span class="sc">$</span>quanti<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>variables_filtradas<span class="ot">&lt;-</span><span class="fu">c</span>(variables_filtradas,variables_filtradas2)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res.PCA, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">col.var=</span><span class="st">"cos2"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">name =</span>variables_filtradas),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkorange"</span>, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para el gráfico de los promedios de las variables ilustrativas, se seleccionan aquellas que tengan valores test mayores a 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>umbral <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>quali.sup <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>coord[<span class="fu">apply</span>(<span class="fu">abs</span>(res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>v.test[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]), <span class="dv">1</span>, max) <span class="sc">&gt;=</span> umbral,])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>quali.sup<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>cos2)[<span class="fu">apply</span>(<span class="fu">abs</span>(res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>v.test[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]), <span class="dv">1</span>, max) <span class="sc">&gt;=</span> umbral]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(quali.sup, <span class="at">x =</span> <span class="st">"Dim.1"</span>, <span class="at">y =</span> <span class="st">"Dim.2"</span>, <span class="at">label =</span> <span class="st">"name"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>v.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Dim.1  Dim.2   Dim.3    Dim.4   Dim.5
female               -2.332  -1.20   3.033   1.7466  0.9668
male                  2.332   1.20  -3.033  -1.7466 -0.9668
dzgroup_A.M.S       -13.369  21.73 -13.064  -5.1702  3.7811
dzgroup_C             4.943   2.68  -3.358  -7.2961 -2.8515
dzgroup_C.C          12.156  -3.99   5.613   2.3167  2.6549
dzgroup_CHF          30.684 -13.64  -2.604   8.7531 -1.5187
dzgroup_Coma        -35.229  -3.14  10.545 -13.9374 20.9100
dzgroup_COPD         17.954  -7.73   7.825  11.6772 -4.1807
dzgroup_L.C           3.818 -11.34   9.580   2.8130 -8.7274
dzgroup_M.M         -23.893   4.40  -4.157  -1.7908 -9.3892
dzclass_A.M         -25.913  23.58 -14.991  -6.0112 -1.3636
dzclass_C            10.872 -11.90  11.475   3.7942 -5.5218
dzclass_C.C.C        38.110 -14.36   1.518  10.9176 -5.3599
dzclass_Coma        -35.229  -3.14  10.545 -13.9374 20.9100
num.co_0             -8.309  15.43  -4.925 -10.1174  8.5916
num.co_1             -6.183   2.17   2.155  -0.8182 -0.9480
num.co_2              0.935  -4.77  -0.550   4.6595 -3.8257
num.co_3              7.758  -4.79   1.393   2.8399 -0.9804
num.co_4+             7.562  -7.24   1.150   2.1333 -1.2137
$11-$25k              2.734  -0.34   1.036  -0.8416 -0.0428
$25-$50k              0.392   5.56  -3.096  -3.0296 -1.0077
&gt;$50k                 1.347   3.00  -2.608  -2.2473  0.7184
under $11k            6.416  -2.05   2.865  -0.5966 -2.4480
O                     0.166  10.21  -4.783 -13.3820 -0.0056
W                    -0.166 -10.21   4.783  13.3820  0.0056
diabetes_no          -2.427   6.33  -0.899  -3.4465 -4.6872
diabetes_yes          2.427  -6.33   0.899   3.4465  4.6872
dementia_no           4.663  11.11  -8.424  -9.4508 -4.2138
dementia_yes         -4.663 -11.11   8.424   9.4508  4.2138
ca_metastatic         2.339 -11.67  10.345   4.1038 -8.3944
ca_no                 9.182  11.76  -9.725  -6.3453  9.7861
ca_yes              -15.381  -2.54   1.286   3.9354 -3.6526
dnr_no               43.044  11.75  -7.565  -4.6886  1.9941
dnr_yes             -43.044 -11.75   7.565   4.6886 -1.9941
adlp_0               30.049  -2.69  -0.996   1.4519 -1.5976
adlp_1               16.082  -5.46   3.582   3.7756 -0.7972
adlp_2               10.664  -4.02   0.941   3.6901 -1.0973
adlp_3                5.773  -4.11   0.020   2.8558 -1.5902
adlp_4                4.772  -3.68   0.810   2.4465 -0.7222
adlp_5                5.806  -2.59   1.029  -0.8308 -2.8662
adlp_6                5.107  -0.50  -0.660  -0.6054 -1.9379
adlp_7                1.821  -0.90   0.065   0.0037 -2.4080
adls_0                4.660   7.72  -4.376  -6.4864  0.3349
adls_1                0.738  -1.37   2.494   2.6144  0.8007
adls_2                0.695  -1.26   2.338   4.2430 -0.9251
adls_3                0.312  -2.05   1.485   2.2037 -1.9980
adls_4                1.082  -1.20   2.408   2.0281 -0.3825
adls_5               -2.075  -0.85   1.732   1.7530 -3.4469
adls_6               -3.004  -1.50   1.381  -1.0198 -0.7011
adls_7               -6.420  -1.57   2.241  -1.1627  2.4175
death_no             29.256  15.19  -8.203  -5.0605  5.1246
death_yes           -29.256 -15.19   8.203   5.0605 -5.1246
hospdead_no          57.225  -3.39   4.779   8.3157  2.9831
hospdead_yes        -57.225   3.39  -4.779  -8.3157 -2.9831
&lt;2 mo. follow-up    -52.345  -4.50   1.120  -3.6616 -3.9992
adl&gt;=4 (&gt;=5 if sur)   0.016   2.57   3.534   2.3771  2.3516
Coma or Intub        -4.780   2.21  -3.008  -0.0389  2.0380
no(M2 and SIP pres)  36.402  -0.13  -1.926   1.4774  1.5914
SIP&gt;=30              10.271   2.31  -1.915  -0.2273 -1.5321</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res.PCA<span class="sc">$</span>quali.sup<span class="sc">$</span>coord</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Dim.1   Dim.2   Dim.3   Dim.4     Dim.5
female              -0.04601 -0.0170  0.0360  0.0201  0.010030
male                 0.03573  0.0132 -0.0280 -0.0156 -0.007789
dzgroup_A.M.S       -0.29314  0.3411 -0.1725 -0.0662  0.043594
dzgroup_C            0.35354  0.1374 -0.1446 -0.3047 -0.107245
dzgroup_C.C          0.86585 -0.2033  0.2408  0.0963  0.099439
dzgroup_CHF          1.25852 -0.4005 -0.0643  0.2096 -0.032753
dzgroup_Coma        -2.31446 -0.1477  0.4172 -0.5346  0.722324
dzgroup_COPD         0.90561 -0.2791  0.2377  0.3439 -0.110882
dzgroup_L.C          0.19947 -0.4242  0.3014  0.0858 -0.239734
dzgroup_M.M         -1.42631  0.1882 -0.1495 -0.0624 -0.294719
dzclass_A.M         -0.48401  0.3153 -0.1686 -0.0656 -0.013392
dzclass_C            0.43975 -0.3445  0.2795  0.0896 -0.117441
dzclass_C.C.C        0.97865 -0.2640  0.0235  0.1637 -0.072373
dzclass_Coma        -2.31446 -0.1477  0.4172 -0.5346  0.722324
num.co_0            -0.37495  0.4983 -0.1338 -0.2666  0.203859
num.co_1            -0.15313  0.0385  0.0321 -0.0118 -0.012346
num.co_2             0.02720 -0.0992 -0.0096  0.0791 -0.058511
num.co_3             0.31317 -0.1383  0.0339  0.0669 -0.020809
num.co_4+            0.35468 -0.2429  0.0325  0.0584 -0.029933
$11-$25k             0.10588 -0.0094  0.0242 -0.0190 -0.000871
$25-$50k             0.01880  0.1908 -0.0895 -0.0849 -0.025421
&gt;$50k                0.08217  0.1309 -0.0958 -0.0800  0.023044
under $11k           0.16506 -0.0377  0.0444 -0.0090 -0.033113
O                    0.00559  0.2463 -0.0971 -0.2633 -0.000099
W                   -0.00149 -0.0656  0.0258  0.0701  0.000026
diabetes_no         -0.02079  0.0388 -0.0046 -0.0172 -0.021110
diabetes_yes         0.08567 -0.1600  0.0191  0.0710  0.086991
dementia_no          0.01486  0.0253 -0.0162 -0.0176 -0.007062
dementia_yes        -0.44226 -0.7542  0.4812  0.5234  0.210162
ca_metastatic        0.08033 -0.2868  0.2139  0.0823 -0.151568
ca_no                0.11498  0.1054 -0.0733 -0.0464  0.064441
ca_yes              -0.66979 -0.0791  0.0337  0.1001 -0.083633
dnr_no               0.55028  0.1075 -0.0582 -0.0350  0.013404
dnr_yes             -1.01789 -0.1988  0.1077  0.0647 -0.024795
adlp_0               1.03500 -0.0664 -0.0207  0.0292 -0.028933
adlp_1               0.96074 -0.2334  0.1289  0.1317 -0.025043
adlp_2               0.95312 -0.2571  0.0506  0.1926 -0.051568
adlp_3               0.77555 -0.3950  0.0016  0.2240 -0.112330
adlp_4               0.70620 -0.3903  0.0721  0.2114 -0.056190
adlp_5               0.78266 -0.2501  0.0835 -0.0654 -0.203160
adlp_6               0.85123 -0.0599 -0.0662 -0.0589 -0.169848
adlp_7               0.42179 -0.1494  0.0091  0.0005 -0.293327
adls_0               0.11255  0.1335 -0.0636 -0.0915  0.004253
adls_1               0.03592 -0.0477  0.0731  0.0743  0.020487
adls_2               0.05184 -0.0672  0.1050  0.1848 -0.036293
adls_3               0.02809 -0.1325  0.0806  0.1159 -0.094640
adls_4               0.11062 -0.0879  0.1482  0.1210 -0.020558
adls_5              -0.18239 -0.0537  0.0917  0.0899 -0.159274
adls_6              -0.24269 -0.0869  0.0672 -0.0481 -0.029786
adls_7              -0.60372 -0.1057  0.1269 -0.0638  0.119534
death_no             0.74331  0.2762 -0.1255 -0.0751  0.068462
death_yes           -0.34810 -0.1293  0.0588  0.0352 -0.032062
hospdead_no          0.58855 -0.0250  0.0296  0.0499  0.016132
hospdead_yes        -1.68210  0.0713 -0.0846 -0.1427 -0.046107
&lt;2 mo. follow-up    -1.25964 -0.0774  0.0162 -0.0514 -0.050602
adl&gt;=4 (&gt;=5 if sur)  0.00082  0.0956  0.1106  0.0722  0.064282
Coma or Intub       -1.23586  0.4091 -0.4683 -0.0059  0.277040
no(M2 and SIP pres)  0.88938 -0.0023 -0.0283  0.0211  0.020444
SIP&gt;=30              0.69496  0.1119 -0.0780 -0.0090 -0.054509</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.PCA</span>(res.PCA, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">label =</span><span class="fu">c</span>(<span class="st">'none'</span>),<span class="at">choix =</span> <span class="fu">c</span>(<span class="st">"ind"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.PCA</span>(res.PCA, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">label =</span><span class="fu">c</span>(<span class="st">'none'</span>),<span class="at">choix =</span> <span class="fu">c</span>(<span class="st">"ind"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.PCA</span>(res.PCA, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="at">label =</span><span class="fu">c</span>(<span class="st">'none'</span>),<span class="at">choix =</span> <span class="fu">c</span>(<span class="st">"ind"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="acm" class="level3">
<h3 class="anchored" data-anchor-id="acm">ACM</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">43</span>,<span class="dv">44</span>,<span class="dv">45</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sex          dzgroup      dzclass     num.co           income     race    
 female:3980   A.M.S  :3515   A.M  :4227   0 :1177   $11-$25k  :1527   O:1914  
 male  :5125   CHF    :1387   C    :1420   1 :3006   $25-$50k  :1057   W:7191  
               COPD   : 967   C.C.C:2862   2 :2397   &gt;$50k     : 684           
               L.C    : 908   Coma : 596   3 :1425   under $11k:2855           
               M.M    : 712                4+:1100   NA's      :2982           
               Coma   : 596                                                    
               (Other):1020                                                    
 diabetes   dementia            ca        dnr            adlp     
 no :7327   no :8809   metastatic:1858   no :5910   0      :1849  
 yes:1778   yes: 296   no        :5995   yes:3195   1      : 711  
                       yes       :1252              2      : 332  
                                                    3      : 150  
                                                    5      : 149  
                                                    (Other): 273  
                                                    NA's   :5641  
      adls      death      hospdead                   sfdm2     
 0      :3108   no :2904   no :6745   &lt;2 mo. follow-up   :3123  
 1      :1031   yes:6201   yes:2360   adl&gt;=4 (&gt;=5 if sur): 916  
 2      : 469                         Coma or Intub      :  41  
 6      : 403                         no(M2 and SIP pres):3061  
 5      : 343                         SIP&gt;=30            : 564  
 (Other): 884                         NA's               :1400  
 NA's   :2867                                                   </code></pre>
</div>
</div>
<p>Se eligen las variables numéricas como ilustrativas, y las variables sfdm2, dzgroup y los índices de actividad diaria como suplementarias para realizar el ACM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>acm <span class="ot">&lt;-</span> <span class="fu">MCA</span>(datos,<span class="at">quanti.sup=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">26</span>,<span class="dv">27</span>,<span class="dv">28</span>,<span class="dv">29</span>,<span class="dv">30</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>,<span class="dv">36</span>,<span class="dv">37</span>,<span class="dv">38</span>,<span class="dv">39</span>,<span class="dv">42</span>),<span class="at">quali.sup=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">45</span>),<span class="at">graph=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(acm<span class="sc">$</span>eig[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se realiza el diagrama de barras correspondiente a los valores propios más altos y se seleccionan 17 ejes para llevar a cabo el proceso de agrupamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">11</span> <span class="co"># poner el numero de activas que hicieron los planos</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> acm<span class="sc">$</span>eig[acm<span class="sc">$</span>eig[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">/</span>s, <span class="dv">1</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> ( s <span class="sc">/</span> (s <span class="sc">-</span> <span class="dv">1</span>) )<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> ( l <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span>s) )<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ptau <span class="ot">&lt;-</span> tau <span class="sc">/</span> <span class="fu">sum</span>( tau ) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ptau, <span class="at">col=</span><span class="st">"darkred"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al realizar el histograma de Benzecri, se decide analizar 3 ejes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(acm, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede observar que lo que más contribuye al primer eje factorial son: tener metástasis o no tener cáncer, tener cáncer, una comorbilidad (COPD/CHF/Cirrhosis) y no haber muerto a lo largo del estudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(acm, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el segundo eje factorial contribuyen: haber muerto en el hospital o no, tener o no una orden de reanimación, y tener cáncer o no.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(acm, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el tercer eje, lo que más contribuye es tener 4 o más comorbilidades o ninguna, tener diabetes, tener COPD/CHF/Cirrhosis, no haber muerto y tener ARF/MOSF.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establecer un umbral mínimo de calidad de representación</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>umbral_cos2 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>variables_filtradas <span class="ot">&lt;-</span> <span class="fu">rownames</span>(acm<span class="sc">$</span>var<span class="sc">$</span>cos2)[<span class="fu">apply</span>(acm<span class="sc">$</span>var<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un gráfico solo con las variables seleccionadas</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">col.var =</span> <span class="st">"cos2"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">name =</span> variables_filtradas),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>), </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Las variables más representadas en el primer plano muestran que las personas que murieron en el hospital tenían orden de reanimación. También se observa que las personas con metástasis no presentaban ninguna comorbilidad y no tenían orden de reanimación. Al parecer, las personas con CCC no murieron y parecen tener más comorbilidades. Se puede observar que las personas que murieron se ubican al otro lado de las variables “cáncer” y “metástasis”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las variables según su cos2 en los ejes seleccionados (1 y 3)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>umbral_cos2 <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>variables_filtradas <span class="ot">&lt;-</span> <span class="fu">rownames</span>(acm<span class="sc">$</span>var<span class="sc">$</span>cos2)[<span class="fu">apply</span>(acm<span class="sc">$</span>var<span class="sc">$</span>cos2[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="dv">1</span>, sum) <span class="sc">&gt;=</span> umbral_cos2]</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un gráfico solo con las variables seleccionadas</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">col.var =</span> <span class="st">"cos2"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">name =</span> variables_filtradas),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>), </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El segundo plano factorial muestra cómo se separan las personas con varias comorbilidades de las que no tienen. Se puede observar que las personas con más comorbilidades son las que suelen morir más, y que las personas con cáncer y metástasis presentan una comorbilidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.MCA</span>(acm, <span class="at">choix=</span><span class="st">'quanti.sup'</span>,<span class="at">title=</span><span class="st">"Supplementary quantitatives variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 19 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En el círculo de correlación se muestra cómo los índices suministrados por los doctores están altamente relacionados con la supervivencia de los pacientes, indicando que, entre más altos sean estos índices, mayor es la probabilidad de que el paciente sobreviva.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.MCA</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),<span class="at">choix=</span><span class="st">'quanti.sup'</span>,<span class="at">title=</span><span class="st">"Supplementary quantitatives variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 26 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">choice =</span> <span class="st">"mca.cor"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 21 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">choice =</span> <span class="st">"mca.cor"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ggrepel: 28 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.MCA</span>(acm,<span class="at">label =</span><span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.MCA</span>(acm, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">label =</span><span class="fu">c</span>(<span class="st">'none'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al observar la nube de individuos, se puede notar que pocos tenían 0 comorbilidades, siendo la mayoría quienes tenían una. Además, se puede ver claramente la separación entre los pacientes con cáncer y/o metástasis y aquellos sin estas condiciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># poner 1000}</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>res.HCPC<span class="ot">&lt;-</span><span class="fu">HCPC</span>(acm,<span class="at">nb.clust=</span><span class="dv">3</span>,<span class="at">kk=</span><span class="dv">1000</span>,<span class="at">consol=</span><span class="cn">FALSE</span>,<span class="at">graph=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.HCPC</span>(res.HCPC,<span class="at">choice=</span><span class="st">'tree'</span>,<span class="at">title=</span><span class="st">'Hierarchical tree'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.HCPC</span>(res.HCPC,<span class="at">choice=</span><span class="st">'map'</span>,<span class="at">draw.tree=</span><span class="cn">FALSE</span>,<span class="at">title=</span><span class="st">'Factor map'</span>,<span class="at">ind.names=</span>F,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.HCPC</span>(res.HCPC,<span class="at">choice=</span><span class="st">'map'</span>,<span class="at">draw.tree=</span><span class="cn">FALSE</span>,<span class="at">title=</span><span class="st">'Factor map'</span>,<span class="at">ind.names=</span>F,<span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analisis-Descriptivo-Multivariado_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al construir el árbol, se eligen 3 grupos basándose en el diagrama de barras del dendrograma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(res.HCPC<span class="sc">$</span>desc.var<span class="sc">$</span>category<span class="sc">$</span><span class="st">`</span><span class="at">1</span><span class="st">`</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Cla/Mod Mod/Cla Global p.value v.test
hospdead=hospdead_no         75.8    93.2   74.1   0.000    Inf
death=death_no               94.2    49.9   31.9   0.000    Inf
dnr=dnr_no                   78.7    84.8   64.9   0.000    Inf
ca=ca_no                     76.8    84.0   65.8   0.000    Inf
dzclass=dzclass_C.C.C        95.1    49.6   31.4   0.000    Inf
dzgroup=dzgroup_CHF          97.8    24.7   15.2   0.000   35.8
sfdm2=no(M2 and SIP pres)    80.4    44.9   33.6   0.000   28.7
dzgroup=dzgroup_COPD         93.1    16.4   10.6   0.000   24.5
dzgroup=dzgroup_C            91.3     8.5    5.6   0.000   16.2
sfdm2=SIP&gt;=30                86.3     8.9    6.2   0.000   14.0
num.co=num.co_4+             77.9    15.6   12.1   0.000   13.2
sfdm2=adl&gt;=4 (&gt;=5 if sur)    76.7    12.8   10.1   0.000   11.1
adlp=adlp_0                  71.3    24.0   20.3   0.000   11.0
num.co=num.co_3              72.0    18.7   15.7   0.000   10.1
dzgroup=dzgroup_A.M.S        66.7    42.7   38.6   0.000   10.0
sfdm2=sfdm2.NA               71.9    18.3   15.4   0.000    9.8
adlp=adlp_1                  75.5     9.8    7.8   0.000    8.9
income=under $11k            65.7    34.2   31.4   0.000    7.2
adls=adls_0                  65.1    36.9   34.1   0.000    6.8
diabetes=diabetes_yes        66.6    21.6   19.5   0.000    6.2
num.co=num.co_0              67.0    14.4   12.9   0.000    5.2
adlp=adlp_2                  72.0     4.4    3.6   0.000    4.5
adlp=adlp_6                  78.6     1.4    1.1   0.000    3.9
dementia=dementia_no         60.6    97.3   96.7   0.000    3.7
adlp=adlp_5                  73.8     2.0    1.6   0.000    3.5
dzclass=dzclass_A.M          62.1    47.8   46.4   0.001    3.3
adlp=adlp_4                  71.0     1.6    1.4   0.013    2.5
sex=male                     61.2    57.2   56.3   0.029    2.2
adls=adls_1                  63.3    11.9   11.3   0.031    2.2
income=$11-$25k              62.5    17.4   16.8   0.044    2.0
sex=female                   59.0    42.8   43.7   0.029   -2.2
adls=adls_7                  53.5     2.9    3.3   0.016   -2.4
ca=ca_yes                    56.0    12.8   13.8   0.001   -3.3
dementia=dementia_yes        49.7     2.7    3.3   0.000   -3.7
income=&gt;$50k                 53.4     6.7    7.5   0.000   -3.8
income=income.NA             56.2    30.5   32.8   0.000   -5.5
diabetes=diabetes_no         58.7    78.4   80.5   0.000   -6.2
adls=adls.NA                 54.4    28.5   31.5   0.000   -7.6
dzgroup=dzgroup_M.M          39.3     5.1    7.8   0.000  -11.7
adlp=adlp.NA                 52.9    54.4   62.0   0.000  -18.5
dzclass=dzclass_Coma         23.7     2.6    6.5   0.000  -18.8
dzgroup=dzgroup_Coma         23.7     2.6    6.5   0.000  -18.8
num.co=num.co_1              44.8    24.6   33.0   0.000  -21.0
dzgroup=dzgroup_C.C           0.0     0.0    5.6   0.000  -31.4
sfdm2=&lt;2 mo. follow-up       25.6    14.6   34.3   0.000   -Inf
hospdead=hospdead_yes        15.8     6.8   25.9   0.000   -Inf
death=death_yes              44.3    50.1   68.1   0.000   -Inf
dnr=dnr_yes                  26.1    15.2   35.1   0.000   -Inf
ca=ca_metastatic              9.5     3.2   20.4   0.000   -Inf
dzclass=dzclass_C             0.0     0.0   15.6   0.000   -Inf
dzgroup=dzgroup_L.C           0.0     0.0   10.0   0.000   -Inf</code></pre>
</div>
</div>
<p>Predominan los pacientes menos graves o sin complicaciones fatales, con una baja mortalidad hospitalaria (hospdead_no, death_no). Estos pacientes presentan una alta prevalencia de enfermedades crónicas controladas, como insuficiencia cardíaca congestiva (dzgroup_CHF), EPOC (dzgroup_COPD) y otras condiciones controladas. Además, tienen una mayor capacidad funcional y menor gravedad, con un número mayor de co-morbilidades leves a moderadas (num.co_3, num.co_4+). También es destacable la clasificación de enfermedades crónicas controladas (dzclass_C.C.C) y la prevalencia de diabetes (diabetes_yes). En cuanto al estado económico, un porcentaje considerable pertenece a los ingresos bajos, con valores por debajo de $11k.No se encuentran pacientes con enfermedades terminales ni decisiones de no reanimar (dnr_no).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(res.HCPC<span class="sc">$</span>desc.var<span class="sc">$</span>category<span class="sc">$</span><span class="st">`</span><span class="at">2</span><span class="st">`</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Cla/Mod Mod/Cla Global p.value v.test
sfdm2=&lt;2 mo. follow-up      60.68   86.61   34.3   0.000    Inf
hospdead=hospdead_yes       78.31   84.46   25.9   0.000    Inf
death=death_yes             35.16   99.63   68.1   0.000    Inf
dnr=dnr_yes                 61.19   89.35   35.1   0.000    Inf
adlp=adlp.NA                35.84   92.41   62.0   0.000   36.7
dzclass=dzclass_A.M         37.95   73.31   46.4   0.000   29.2
dzclass=dzclass_Coma        74.50   20.29    6.5   0.000   27.1
dzgroup=dzgroup_Coma        74.50   20.29    6.5   0.000   27.1
dzgroup=dzgroup_M.M         60.67   19.74    7.8   0.000   21.8
ca=ca_yes                   44.01   25.18   13.8   0.000   16.8
dzgroup=dzgroup_A.M.S       33.34   53.56   38.6   0.000   16.3
dementia=dementia_yes       48.65    6.58    3.3   0.000    9.3
adls=adls_7                 39.87    5.48    3.3   0.000    6.2
income=income.NA            27.77   37.84   32.8   0.000    5.8
num.co=num.co_0             30.84   16.59   12.9   0.000    5.7
sex=female                  26.71   48.58   43.7   0.000    5.3
adls=adls_6                 32.75    6.03    4.4   0.000    4.1
race=O                      26.65   23.31   21.0   0.003    3.0
diabetes=diabetes_yes       26.49   21.53   19.5   0.007    2.7
adls=adls.NA                25.43   33.32   31.5   0.035    2.1
diabetes=diabetes_no        23.43   78.47   80.5   0.007   -2.7
ca=ca_no                    23.15   63.44   65.8   0.007   -2.7
race=W                      23.34   76.69   79.0   0.003   -3.0
adlp=adlp_6                 11.22    0.50    1.1   0.001   -3.2
num.co=num.co_3             20.70   13.48   15.7   0.001   -3.2
income=&gt;$50k                18.71    5.85    7.5   0.001   -3.5
income=$11-$25k             20.56   14.35   16.8   0.000   -3.5
income=$25-$50k             19.68    9.51   11.6   0.000   -3.6
adlp=adlp_4                  8.06    0.46    1.4   0.000   -4.6
num.co=num.co_4+            18.36    9.23   12.1   0.000   -4.8
sex=male                    21.95   51.42   56.3   0.000   -5.3
adlp=adlp_5                  6.71    0.46    1.6   0.000   -5.6
adlp=adlp_3                  6.67    0.46    1.6   0.000   -5.6
adls=adls_0                 19.95   28.34   34.1   0.000   -6.6
adlp=adlp_2                  7.23    1.10    3.6   0.000   -8.2
sfdm2=adl&gt;=4 (&gt;=5 if sur)   13.43    5.62   10.1   0.000   -8.4
dzgroup=dzgroup_C            8.66    2.01    5.6   0.000   -9.2
dementia=dementia_no        23.20   93.42   96.7   0.000   -9.3
ca=ca_metastatic            13.40   11.38   20.4   0.000  -12.6
sfdm2=SIP&gt;=30                3.37    0.87    6.2   0.000  -14.0
dzgroup=dzgroup_COPD         6.93    3.06   10.6   0.000  -14.7
adlp=adlp_1                  3.94    1.28    7.8   0.000  -15.2
dzgroup=dzgroup_C.C          0.00    0.00    5.6   0.000  -16.9
sfdm2=sfdm2.NA               5.86    3.75   15.4   0.000  -19.4
dzgroup=dzgroup_L.C          0.00    0.00   10.0   0.000  -22.9
dzgroup=dzgroup_CHF          2.09    1.32   15.2   0.000  -24.7
adlp=adlp_0                  3.57    3.02   20.3   0.000  -26.5
dzclass=dzclass_C            0.00    0.00   15.6   0.000  -29.2
dzclass=dzclass_C.C.C        4.89    6.40   31.4   0.000  -32.0
sfdm2=no(M2 and SIP pres)    1.90    2.65   33.6   0.000   -Inf
hospdead=hospdead_no         5.04   15.54   74.1   0.000   -Inf
death=death_no               0.28    0.37   31.9   0.000   -Inf
dnr=dnr_no                   3.94   10.65   64.9   0.000   -Inf</code></pre>
</div>
</div>
<p>Las características principales de este grupo están asociadas a pacientes críticos, con una alta mortalidad (death_yes, hospdead_yes) y una alta frecuencia de condiciones terminales, como coma (dzclass_Coma) o intubación reciente (sfdm2=&lt;2 mo. follow-up). Además, presentan una mayor proporción de pacientes con órdenes de no reanimar (dnr_yes). En términos de gravedad funcional, muchos presentan dependencia severa o carecen de datos funcionales (adlp.NA). También se observa una mayor proporción de pacientes con cáncer avanzado (ca_metastatic). En cuanto a los aspectos socioeconómicos, se destaca una distribución homogénea entre los diferentes niveles de ingresos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(res.HCPC<span class="sc">$</span>desc.var<span class="sc">$</span>category<span class="sc">$</span><span class="st">`</span><span class="at">3</span><span class="st">`</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Cla/Mod Mod/Cla Global p.value v.test
ca=ca_metastatic           77.072  100.00  20.41   0.000    Inf
dzclass=dzclass_C         100.000   99.16  15.60   0.000    Inf
dzgroup=dzgroup_L.C       100.000   63.41   9.97   0.000    Inf
dzgroup=dzgroup_C.C       100.000   35.75   5.62   0.000    Inf
num.co=num.co_1            30.206   63.41  33.02   0.000   25.8
death=death_yes            20.513   88.83  68.11   0.000   19.8
hospdead=hospdead_no       19.185   90.36  74.08   0.000   16.6
diabetes=diabetes_no       17.879   91.48  80.47   0.000   12.4
adlp=adlp_0                25.149   32.47  20.31   0.000   11.9
income=&gt;$50k               27.924   13.34   7.51   0.000    8.5
dementia=dementia_no       16.199   99.65  96.75   0.000    8.2
adls=adls.NA               20.126   40.29  31.49   0.000    7.7
sfdm2=sfdm2.NA             22.286   21.79  15.38   0.000    7.0
income=$25-$50k            22.233   16.41  11.61   0.000    5.9
dnr=dnr_no                 17.360   71.65  64.91   0.000    5.9
race=W                     16.674   83.73  78.98   0.000    4.9
sfdm2=no(M2 and SIP pres)  17.739   37.92  33.62   0.000    3.7
adlp=adlp_3                27.333    2.86   1.65   0.000    3.6
adlp=adlp_1                20.534   10.20   7.81   0.000    3.5
sex=male                   16.820   60.20  56.29   0.001    3.3
adlp=adlp_2                20.783    4.82   3.65   0.013    2.5
sfdm2=Coma or Intub         2.439    0.07   0.45   0.009   -2.6
adls=adls_1                12.803    9.22  11.32   0.005   -2.8
sex=female                 14.322   39.80  43.71   0.001   -3.3
adls=adls_6                 9.429    2.65   4.43   0.000   -3.8
sfdm2=SIP&gt;=30              10.284    4.05   6.19   0.000   -3.8
sfdm2=&lt;2 mo. follow-up     13.705   29.89  34.30   0.000   -3.9
adls=adls_7                 6.645    1.40   3.31   0.000   -4.8
race=O                     12.173   16.27  21.02   0.000   -4.9
sfdm2=adl&gt;=4 (&gt;=5 if sur)   9.825    6.29  10.06   0.000   -5.4
dnr=dnr_yes                12.707   28.35  35.09   0.000   -5.9
dementia=dementia_yes       1.689    0.35   3.25   0.000   -8.2
num.co=num.co_3             7.298    7.26  15.65   0.000  -10.3
income=under $11k           9.422   18.79  31.36   0.000  -11.6
dzclass=dzclass_Coma        1.846    0.77   6.55   0.000  -11.6
dzgroup=dzgroup_Coma        1.846    0.77   6.55   0.000  -11.6
diabetes=diabetes_yes       6.862    8.52  19.53   0.000  -12.4
dzgroup=dzgroup_C           0.000    0.00   5.58   0.000  -13.2
num.co=num.co_4+            3.727    2.86  12.08   0.000  -13.4
adlp=adlp.NA               11.257   44.34  61.95   0.000  -14.7
dzgroup=dzgroup_M.M         0.000    0.00   7.82   0.000  -15.8
num.co=num.co_0             2.124    1.75  12.93   0.000  -16.3
hospdead=hospdead_yes       5.847    9.64  25.92   0.000  -16.6
dzgroup=dzgroup_COPD        0.000    0.00  10.62   0.000  -18.6
death=death_no              5.510   11.17  31.89   0.000  -19.8
ca=ca_yes                   0.000    0.00  13.75   0.000  -21.4
dzgroup=dzgroup_CHF         0.072    0.07  15.23   0.000  -22.4
dzclass=dzclass_C.C.C       0.035    0.07  31.43   0.000  -34.3
ca=ca_no                    0.000    0.00  65.84   0.000   -Inf
dzclass=dzclass_A.M         0.000    0.00  46.42   0.000   -Inf
dzgroup=dzgroup_A.M.S       0.000    0.00  38.60   0.000   -Inf</code></pre>
</div>
</div>
<p>Las características principales de este grupo están asociadas a pacientes con cáncer avanzado y alta gravedad, con una alta prevalencia de cáncer metastásico (ca_metastatic) y una clasificación severa de enfermedades (dzclass_C y dzgroup_L.C). A pesar de la gravedad de su condición, algunos pacientes mantienen una mayor capacidad funcional residual (adlp_0, num.co_1). En cuanto a los aspectos socioeconómicos, se observa una distribución hacia ingresos elevados (income &gt;$50k). Además, se destaca una menor proporción de comorbilidades como insuficiencia cardíaca y EPOC (dzgroup_CHF, dzgroup_COPD).</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>